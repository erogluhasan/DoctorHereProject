<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.10.xsd">
    <changeSet author="mustafa.gulec" id="dh-15-2023-01-05 16:00" context="sql">
        <sql splitStatements="true">
            create table if not exists dh_doctor
            (
                id   bigint not null generated by default as identity (start with 1) constraint pk_doctor  primary key,
                created_by         varchar(255),
                created_date       timestamp,
                last_modified_date timestamp,
                last_modified_by   varchar(255),
                deleted            boolean default false,
                version            numeric default 0 not null,
                user_id bigint not null,
                newsletter boolean default false,
                name varchar(500),
                surname varchar(500),
                email varchar(500),
                phone varchar(500),
                certificate_no varchar(500),
                patent_no varchar(500),
                graduadate_school varchar(500),
                profession_id bigint,
                interests varchar(500),
                work_hospital varchar(500),
                image_url varchar(150),
                video_url varchar(150),
                cv_url varchar(150),
                online boolean default false,
                approved boolean default false
                );

            ALTER TABLE dh_doctor ADD CONSTRAINT fk_doctor_profession_id FOREIGN KEY (profession_id) REFERENCES dh_profession(id);
            ALTER TABLE dh_doctor ADD CONSTRAINT fk_doctor_user_id FOREIGN KEY (user_id) REFERENCES dhsecurity.app_user(id);

            create table doctor_profession
            (
                doctor_id     bigint not null
                    constraint doctor_profession_dh_doctor_id_fk
                        references dh_doctor,
                profession_id int    not null
                    constraint doctor_profession_dh_profession_id_fk
                        references dh_profession
            );


        </sql>
    </changeSet>


</databaseChangeLog>